<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.121" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Identifier" content="urn:ietf:id:sekar-dns-ul" />
<meta name="DC.Description.Abstract" content="This document proposes a method of extending Dynamic DNS Update to
contain an update lease life, allowing a server to garbage collect
stale resource records." />
<meta name="DC.Creator" content="Kiren Sekar &lt;kiren@apple.com&gt;" />
<meta name="DC.Date.Issued" content="2006-08-28" />
<meta name="DC.Title" content="Dynamic DNS Update Leases" />

    <link rel="icon" href="/images/id.png" type="image/png" />
    <link rel="shortcut icon" href="/images/id.png" type="image/png" />
    <title>draft-sekar-dns-ul-01 - Dynamic DNS Update Leases</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgred"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="../html/" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/id/draft-sekar-dns-ul-01.txt" title="Plaintext version of this document">txt</a>|<a href="/pdf/draft-sekar-dns-ul-01.txt" title="PDF version of this document">pdf</a>] [<a href='https://datatracker.ietf.org/doc/draft-sekar-dns-ul' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="mailto:draft-sekar-dns-ul@ietf.org?subject=draft-sekar-dns-ul%20" title="Send email to the document authors">Email</a>] [<a href="/rfcdiff?difftype=--hwdiff&amp;url2=draft-sekar-dns-ul-01.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="/rfcdiff?url2=draft-sekar-dns-ul-01.txt" title="Side-by-side diff">Diff2</a>] [<a href="/idnits?url=https://tools.ietf.org/id/draft-sekar-dns-ul-01.txt" title="Run an idnits check of this document">Nits</a>] [<a href="https://datatracker.ietf.org/ipr/search/?id=draft-sekar-dns-ul&amp;submit=draft" title="IPR disclosures related to this document">IPR</a>]         </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">Versions: <a href="./draft-sekar-dns-ul-00">00</a> <a href="./draft-sekar-dns-ul-01">01</a>                                                         </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Document: <a href="./draft-sekar-dns-ul-01.txt">draft-sekar-dns-ul-01.txt</a>                      Stuart Cheshire
Internet-Draft                                             Marc Krochmal
Category: Standards Track                           Apple Computer, Inc.
Expires 10th February 2007                                   Kiren Sekar
                                                         Sharpcast, Inc.
                                                        10th August 2006

                       <span class="h1">Dynamic DNS Update Leases</span>

                      &lt;<a href="./draft-sekar-dns-ul-01.txt">draft-sekar-dns-ul-01.txt</a>&gt;

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with <a href="./bcp79#section-6">Section&nbsp;6 of BCP 79</a>.
   For the purposes of this document, the term "<a href="./bcp79">BCP 79</a>" refers
   exclusively to <a href="./rfc3979">RFC 3979</a>, "Intellectual Property Rights in IETF
   Technology", published March 2005.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   <a href="http://www.ietf.org/1id-abstracts.html">http://www.ietf.org/1id-abstracts.html</a>

   The list of Internet-Draft Shadow Directories can be accessed at
   <a href="http://www.ietf.org/shadow.html">http://www.ietf.org/shadow.html</a>


Abstract

   This document proposes a method of extending Dynamic DNS Update to
   contain an update lease life, allowing a server to garbage collect
   stale resource records.














<span class="grey">Expires 10th February 2007       Sekar, et al.                  [Page 1]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey">Internet Draft           Dynamic DNS Update Leases      10th August 2006</span>


<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>. Introduction</span>

   Dynamic DNS Update [<a href="./rfc2136">RFC 2136</a>] allows for a mapping from a persistent
   hostname to a dynamic IP address. This capability is particularly
   beneficial to mobile hosts, whose IP address may frequently change
   with location. However, the mobile nature of such hosts often means
   that dynamically updated resource records are often not properly
   deleted. Consider, for instance, a mobile user who publishes address
   records via dynamic update. If this user unplugs the Ethernet cable
   from their laptop, the address record containing stale information
   will remain on the server indefinitely.  "DNS Scavenging" attempts to
   address this issue by configuring clients and servers with a preset
   refresh interval, however, this approach does not extend to
   zero-configuration environments in which the client and server are
   not under the same administration. An extension to Dynamic Update is
   thus required to tell the server to automatically delete resource
   records if they are not refreshed after a period of time.

   Note that overloading the resource record TTL [<a href="./rfc1035">RFC 1035</a>] is not
   appropriate for purposes of garbage collection. Data that is
   susceptible to frequent change or invalidation, thus requiring a
   garbage collection mechanism, needs a relatively short resource
   record TTL to avoid polluting intermediate DNS caches with stale
   data. Using this TTL, short enough to minimize stale cached data,
   as a garbage collection lease life would result in an unacceptable
   amount of network traffic due to refreshes (see <a href="#section-6">section 6</a> "Refresh
   Messages").


<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>. Conventions and Terminology Used in this Document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in "Key words for use in
   RFCs to Indicate Requirement Levels" [<a href="./rfc2119">RFC 2119</a>].


<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>. Mechanisms</span>

   Dynamic DNS Update Leases is implemented using the standard Dynamic
   Update message format [<a href="./rfc2136">RFC 2136</a>] in conjunction with an ENDS0 OPT
   pseudo-RR [<a href="./rfc2671">RFC 2671</a>] with a new OPT and RDATA format proposed here.
   Encoding the Update Lease Life in an OPT RR requires minimal
   modification to a name server's front-end, and will cause servers
   that do not implement this extension to automatically return a
   descriptive error (NOTIMPL).

<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>. New Assigned Numbers</span>

   EDNS0 OPTION CODE:
           UPDATE-LEASE 2


<span class="grey">Expires 10th February 2007       Sekar, et al.                  [Page 2]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey">Internet Draft           Dynamic DNS Update Leases      10th August 2006</span>


<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>. Update Message Format</span>

   Dynamic DNS Update Leases Requests and Responses are formatted as per
   [<a href="./rfc2136">RFC 2136</a>], with the addition of a single OPT-RR as the last record
   in the Additional section. Note that if a TSIG resource record is
   to be added to authenticate the update [<a href="./rfc2845">RFC 2845</a>], the OPT-RR should
   occur BEFORE the TSIG RR, allowing the message digest in the TSIG to
   contain the OPT-RR.

   The OPT-RR is formatted as follows:

   Field Name       Field Type        Description
   ---------------------------------------------------------------------
   NAME             domain name       empty (root domain)
   TYPE             u_int16_t         OPT
   CLASS            u_int16_t         0
   TTL              u_int32_t         0
   RDLEN            u_int16_t         describes RDATA
   RDATA            octet stream      (see below)

   RDATA Format:

   Field Name        Field Type       Description
   ---------------------------------------------------------------------
   OPTION-CODE       u_int16_t        UPDATE-LEASE (2)
   OPTION-LENGTH     u_int16_t        sizeof(int32_t)
   LEASE             int32_t          desired lease (request) or granted
                                      lease (response), in seconds


   Update Requests contain, in the LEASE field of the OPT RDATA, a
   signed 32-bit integer indicating the lease life, in seconds, desired
   by the client. In Update Responses, this field contains the actual
   lease granted by the server. Note that the lease granted by the
   server may be less than, greater than, or equal to the value
   requested by the client. To reduce network and server load, a
   minimum lease of 30 minutes (1800 seconds) is RECOMMENDED. Note that
   leases are expected to be sufficiently long as to make timer
   discrepancies  (due to transmission latency, etc.) between a client
   and server negligible. Clients that expect the updated records to be
   relatively static MAY request appropriately longer leases. Servers
   MAY grant relatively longer or shorter leases to reduce network
   traffic due to refreshes, or reduce stale data, respectively.

   The Update Lease indicated in the OPT-RR applies to all resource
   records in the Update section.







<span class="grey">Expires 10th February 2007       Sekar, et al.                  [Page 3]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey">Internet Draft           Dynamic DNS Update Leases      10th August 2006</span>


<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>. Refresh Messages</span>

   Resource records not to be deleted by the server MUST be refreshed by
   the client before the lease elapses. Clients SHOULD refresh resource
   records after 75% of the original lease has elapsed. If the client
   uses UDP and does not receive a response from the server, the client
   SHOULD re-try after 2 seconds. The client SHOULD continue to re-try,
   doubling the length of time between each re-try, or re-try using TCP.


<span class="h3"><a class="selflink" name="section-6.1" href="#section-6.1">6.1</a> Coalescing Refresh Messages</span>

   If the client has sent multiple updates to a single server, the
   client MAY include refreshes for all valid updates to that server in
   a single message. This effectively places all records for a client
   on the same expiration schedule, reducing network traffic due to
   refreshes. In doing so, the client includes in the refresh message
   all existing updates to the server, including those not yet close to
   expiration, so long as at least one resource record in the message
   has elapsed at least 75% of its original lease. If the client uses
   UDP, the client MUST NOT coalesce refresh messages if doing so would
   cause truncation of the message; in this case, multiple messages or
   TCP should be used.


<span class="h3"><a class="selflink" name="section-6.2" href="#section-6.2">6.2</a> Refresh Message Format</span>

   Refresh messages are formatted like Dynamic Update Leases Requests
   and Responses (see <a href="#section-5">Section 5</a> "Update Message Format"). The resource
   records to be refreshed are contained in the Update section. These
   same resource records are repeated in the Prerequisite section, as
   an "RRSet exists (value dependent)" prerequisite as per <a href="./rfc2136#section-2.4">[RFC 2136]
   section&nbsp;2.4</a>.  An OPT-RR is the last resource record in the Additional
   section (except for a TSIG record, which, if required, follows the
   OPT-RR). The OPT-RR contains the desired new lease on Requests, and
   the actual granted lease on Responses. The Update Lease indicated in
   the OPT-RR applies to all resource records in the Update section.


<span class="h3"><a class="selflink" name="section-6.3" href="#section-6.3">6.3</a> Server Behavior</span>

   Upon receiving a valid Refresh Request, the server MUST send an
   acknowledgment. This acknowledgment is identical to the Update
   Response format described in <a href="#section-5">section 5</a> "Update Message Format",
   and contains the new lease of the resource records being refreshed.
   If no records in the Refresh Request have completed 75% of their
   leases, the server SHOULD NOT refresh the updates; the response
   should contain the smallest remaining (unrefreshed) lease of all
   records in the refresh message. The server MUST NOT increment the
   SOA serial number of a zone as the result of a refresh.



<span class="grey">Expires 10th February 2007       Sekar, et al.                  [Page 4]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey">Internet Draft           Dynamic DNS Update Leases      10th August 2006</span>


<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>. Garbage Collection</span>

   If the Update Lease of a resource record elapses without being
   refreshed, the server MUST NOT return the expired record in answers
   to queries. The server MAY delete the record from its database.


<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>. Copyright Notice</span>

   Copyright (C) The Internet Society (2006).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="./bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights. For the purposes of this document,
   the term "<a href="./bcp78">BCP 78</a>" refers exclusively to <a href="./rfc3978">RFC 3978</a>, "IETF Rights
   in Contributions", published March 2005.

   This document and the information contained herein are provided on
   an "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE
   REPRESENTS OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE
   INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR
   IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


<span class="h2"><a class="selflink" name="section-9" href="#section-9">9</a>. IANA Considerations</span>

   The EDNS0 OPTION CODE 2 has already been assigned for this DNS
   extension. No additional IANA services are required by this document.


<span class="h2"><a class="selflink" name="section-10" href="#section-10">10</a>. Acknowledgments</span>

   The concepts described in this document have been explored, developed
   and implemented with help from Roger Pantos and Chris Sharp.


<span class="h2"><a class="selflink" name="section-11" href="#section-11">11</a>. Normative References</span>

   [<a name="ref-RFC 1035" id="ref-RFC 1035">RFC 1035</a>] Mockapetris, P., "Domain Names - Implementation and
              Specifications", STD 13, <a href="./rfc1035">RFC 1035</a>, November 1987.

   [<a name="ref-RFC 2119" id="ref-RFC 2119">RFC 2119</a>] <a href="./rfc2119">RFC 2119</a> - Key words for use in RFCs to Indicate
              Requirement Levels

   [<a name="ref-RFC 2136" id="ref-RFC 2136">RFC 2136</a>] Vixie, P., et al., "Dynamic Updates in the Domain Name
              System (DNS UPDATE)", <a href="./rfc2136">RFC 2136</a>, April 1997.

   [<a name="ref-RFC 2671" id="ref-RFC 2671">RFC 2671</a>] Vixie, P., "Extension Mechanisms for DNS (EDNS0)",
              <a href="./rfc2671">RFC 2671</a>, August 1999.


<span class="grey">Expires 10th February 2007       Sekar, et al.                  [Page 5]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey">Internet Draft           Dynamic DNS Update Leases      10th August 2006</span>


<span class="h2"><a class="selflink" name="section-12" href="#section-12">12</a>. Informative References</span>

   [<a name="ref-RFC 2845" id="ref-RFC 2845">RFC 2845</a>] Vixie, P., et al., "Secret Key Transaction Authentication
              for DNS (TSIG)", <a href="./rfc2845">RFC 2845</a>, May 2000.





<span class="h2"><a class="selflink" name="section-13" href="#section-13">13</a>. Authors' Addresses</span>

   Stuart Cheshire
   Apple Computer, Inc.
   1 Infinite Loop
   Cupertino
   California 95014
   USA

   Phone: +1 408 974 3207
   EMail: rfc [at] stuartcheshire [dot] org


   Marc Krochmal
   Apple Computer, Inc.
   1 Infinite Loop
   Cupertino
   California 95014
   USA

   Phone: +1 408 974 4368
   EMail: marc [at] apple [dot] com


   Kiren Sekar
   Sharpcast, Inc.
   250 Cambridge Ave, Suite 101
   Palo Alto
   California 94306
   USA

   Phone: +1 650 323 1960
   EMail: ksekar [at] sharpcast [dot] com











Expires 10th February 2007       Sekar, et al.                  [Page 6]

</pre><br />
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.121, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>
</body>
</html>
